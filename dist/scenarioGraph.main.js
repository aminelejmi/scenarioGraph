var ScenarioGraph=function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,c=e[Symbol.iterator]();!(r=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.r(t),n.d(t,"default",(function(){return c}));var c=function(){function e(t,n){var r=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;i(this,e),o(this,"options",{storeChanges:!1,strokeColor:"bcbdbd",strokeWidth:"3",cardShadowColor:"0,0,0,0.15",selectedCardBorderColor:"228B22",selectedCardBorderWidth:"2"}),o(this,"graphSelected",[]),o(this,"graphTraces",[]),o(this,"currentCols",0),o(this,"getSiblings",(function(e){for(var t=[],n=e.parentNode.firstChild;n;)1===n.nodeType&&n!==e&&t.push(n),n=n.nextSibling;return t})),this.handleOptions(a),n||console.error("Data not found","\nThe object containing the scenario elements is not found\nPlease refer to the documentation for further informations !"),t?(window.addEventListener("resize",(function(){r.handleWindowResize(r.graphSelected)})),this.graphCards=n||[],this.mainContainer=t,this.reformatGraphCards(this.graphCards),this.initGraph()):console.error("HTML container not found","\nThe main container is not found !\nPlease refer to the documentation for further informations !")}var t,n,c;return t=e,(n=[{key:"handleOptions",value:function(e){if(e)for(var t=0,n=Object.entries(e);t<n.length;t++){var i=r(n[t],2),a=i[0],o=i[1];a in this.options&&(this.options[a]=o)}}},{key:"retraceGraph",value:function(){this.traceContainer.innerHTML=this.graphTraces}},{key:"handleWindowResize",value:function(e){var t=this;e.forEach((function(e){t.linkWithPrev(e)}))}},{key:"linkWithPrev",value:function(e){var t=e._id.toString(),n=e._col,r=parseInt(n,10);if(this.graphSelected[r-2]){this.graphSelected[r-1]=e;var i=document.querySelector(".scenario-card[card-id = '".concat(t,"']")),a=this.graphSelected[r-2]._id,o=document.querySelector(".scenario-card[card-id = '".concat(a,"']"));this.graphTraces[r-2]=this.getTrace(this.calculateCoor(o,i)),this.retraceGraph()}}},{key:"getAllowedCards",value:function(e){if(e&&e._children)return e._children}},{key:"getGraphCol",value:function(e){var t=this,n=[];e.forEach((function(e){var r=document.createElement("div");r.classList=["card-btn"],r.addEventListener("click",(function(){t.handleCardClick(e,r)}));var i=document.createElement("div");i.classList=["card-title d-flex flex-column justify-content-center align-items-center"],i.innerHTML='<h6 class="text-center text-black-color">{{title}}</h6>'.replace("{{title}}",e.title)+'<p class="card-description"> {{description}}</p>'.replace("{{description}}",e.description);var a=document.createElement("div");a.classList=["scenario-card shadow-card"],a.setAttribute("card-id",e._id),a.setAttribute("selected",e._selected),a.appendChild(r),a.appendChild(i),n.push(a)}));var r=document.createElement("div");return r.classList=["cards-col col-3 d-flex flex-column justify-content-around align-items-center"],r.setAttribute("col-pos",this.currentCols),n.forEach((function(e){r.appendChild(e)})),r}},{key:"handleCardClick",value:function(e,t){var n=e._col;this.removeColsAfter(n),this.linkWithPrev(e),this.addGrahpCol(this.getAllowedCards(e)),this.getSiblings(t.parentElement).forEach((function(e){e.classList.remove("selected-card"),e._selected=!1})),t.parentElement.classList.add("selected-card"),e._selected=!0,this.options.storeChanges&&(localStorage.graphSelected=JSON.stringify(this.graphSelected)),this.traceContainer.style.width=this.mainContainer.scrollWidth}},{key:"addGrahpCol",value:function(e){e&&(this.currentCols++,this.mainContainer.appendChild(this.getGraphCol(e)))}},{key:"getNextSiblings",value:function(e){if(e){for(var t=[];e=e.nextSibling;)t.push(e);return t}}},{key:"removeColsAfter",value:function(e){var t=parseInt(e,10),n=document.querySelector(".cards-col[col-pos='".concat(e,"']")),r=this.getNextSiblings(n);this.currentCols=t,r&&(r.forEach((function(e){return e.remove()})),this.graphTraces.splice(t-1,this.graphTraces.length),this.graphSelected.splice(t,this.graphSelected.length),this.retraceGraph())}},{key:"initContainers",value:function(){this.traceContainer=this.mainContainer.querySelector("svg"),this.traceContainer.classList=["scenario-trace"],this.mainContainer.appendChild(this.traceContainer),this.mainContainer.classList=["d-flex flex-row justify-content-start align-items-center main_scenario_container"]}},{key:"initGraph",value:function(){var e=this;this.graphSelected.push(this.graphCards[0]),this.initContainers(),this.addGrahpCol(this.graphCards),localStorage.graphSelected&&(this.graphSelected=JSON.parse(localStorage.graphSelected),this.graphSelected.forEach((function(t){e.linkWithPrev(t),e.addGrahpCol(e.getAllowedCards(t));var n=e.graphSelected.map((function(e){return e._id}));document.querySelectorAll(".scenario-card").forEach((function(e){n.includes(e.getAttribute("card-id"))&&e.classList.add("selected-card")}))}))),this.options.storeChanges||localStorage.removeItem("graphSelected"),this.initStyles()}},{key:"initStyles",value:function(){var e=this.options.strokeColor,t=this.options.strokeWidth,n=this.options.cardShadowColor,r=this.options.selectedCardBorderColor,i=this.options.selectedCardBorderWidth,a=document.createElement("style");a.type="text/css",a.innerHTML="\n            .main_scenario_container line {\n                stroke: #".concat(e,";\n                stroke-width: ").concat(t,"px;\n             }\n             .shadow-card {\n                box-shadow:0 .5rem 1rem rgba(").concat(n,")\n            }\n            .selected-card {\n                border: solid ").concat(i,"px #").concat(r,";\n            }\n        "),document.getElementsByTagName("head")[0].appendChild(a)}},{key:"getPos",value:function(e){for(var t=0,n=0;null!=e;)t+=e.offsetLeft,n+=e.offsetTop,e=e.offsetParent;return{x:t,y:n}}},{key:"calculateCoor",value:function(e,t){var n=this.getPos(this.mainContainer),r=this.getPos(e),i=this.getPos(t);return r.x-=n.x-e.clientWidth/2,i.x-=n.x-t.clientWidth/2,r.y-=n.y-e.clientWidth/2,i.y-=n.y-t.clientWidth/2,{elem1:r,elem2:i,distCards:(i.x-r.x)/2}}},{key:"getTrace",value:function(e){return'<line x1="'.concat(e.elem1.x,'"\n                        x2="').concat(e.elem1.x+e.distCards,'"\n                        y1="').concat(e.elem1.y,'"\n                        y2="').concat(e.elem1.y,'"></line>\n                \n                <line x1="').concat(e.elem1.x+e.distCards,'"\n                        x2="').concat(e.elem2.x-e.distCards,'"\n                        y1="').concat(e.elem1.y,'"\n                        y2="').concat(e.elem2.y,'"></line>\n                \n                <line x1="').concat(e.elem2.x-e.distCards,' "\n                        x2="').concat(e.elem2.x,'"\n                        y1="').concat(e.elem2.y,'"\n                        y2="').concat(e.elem2.y,'"></line>')}},{key:"reformatGraphCards",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;e.forEach((function(e,r){e.description=e.description?e.description:"",e._selected=!1,e._col=n?n+1:1,e._row=r+1,e._id=e._col.toString()+e._row.toString(),e._children&&t.reformatGraphCards(e._children,e._col)}))}},{key:"generateScenario",value:function(){return this.graphSelected}},{key:"generateScenarioFields",value:function(e){var t=[];return 1===e.length?this.graphSelected.forEach((function(n){e[0]in n&&t.push(n[e[0]])})):this.graphSelected.forEach((function(n){var r={};e.forEach((function(e){e in n&&(r[e]=n[e])})),t.push(r)})),t}}])&&a(t.prototype,n),c&&a(t,c),e}()}]);